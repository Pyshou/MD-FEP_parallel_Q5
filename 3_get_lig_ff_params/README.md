# Get OPLS ligand force field parameters

For each FEP, you will need the force field parameters of both the MD topology's ligand (usually the biggest) and of the one to compare it to. I would advice to run a few relevant retrospective predictions to calibrate your MD/FEP protocol first (i.e. protonation states in the binding site, sphere size, simulation time..) and see if it allows to reproduce experimental binding affinities.


## **Option 1. Using hetgrp_ffgen (still accessible on Tetralith, at least on Pierre's account)**



## **Option 2. Using ffld_server (accessible on CSB)**

Go t

## **Option 3. Using new force field parameters (LigParGen)**

Go to http://zarbi.chem.yale.edu/ligpargen/index.html . For Q (as other MD engines), this can generate a ligand force field library file as well as paramterers to insert in your "Qopplsaa.prm" force field file. But do not use it until they have fix the problem of wrongly multiplied force constants for bonded parameters for Q. 

What you can eventually do though is to use better quality partial charges by translating the information from the generated "LIG.lib" file (especially if you will carry out transformations of heterocycles, atypical chemical moieties or do scaffold hopping/optimization in general). 

- Use 1.14\*CM1A-LBCC charges if there are not charged ligands in your series and note that the resulting partial charges from electrostatic potential fit will be dependent on the provided conformation of the uploaded ligand. Before the next step, make sure the LigParGen PDB (that you can download from the OpenMM "result" section) matches the coordinates of your initial PDB. Also download the generated QLIB file in the Q section. And run:

```./prep_mapping_files_ligpargen2Q.py rec.pdb LIG.pdb 0.2``` # rec.pdb being the initial structure and LIG.pdb the one generated by LigParGen. Here using an 0.2 Angstroms distance treshold to define atoms as identical for sure. Check the generated mapping_ligpargen2Q.txt mapping file (minimal distances beyond that treshold will generate guessed atom names followed by "?", so correct or remove these characters if correct), and run:

```./ligpargen2Q_charges.py LIG.lib LIG_prgn.lib N9``` # LIG.lib is a library obtained from the above procedure and LIG_prgn.lib the one form LigParGen. This generates a LIG_new.lib file with new partial charges and original atom names (replace the old one by it then). If the total charge was not an integer, just add an opposite charge to the one of a burried atom in your ligand and check with the following:

```./check_fractional_charges_LIGlib.py LIG.lib``` # (Assuming LIG.lib is the previous LIG_new.lib file renamed).
